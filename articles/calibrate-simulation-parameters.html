<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibrate simulation parameters • RITHMS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate simulation parameters">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RITHMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/generate-figures.html">Generate figures</a></li>
    <li><a class="dropdown-item" href="../articles/import-data.html">Data Importation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SolenePety/RITHMS"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="calibrate-simulation-parameters_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="calibrate-simulation-parameters_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="calibrate-simulation-parameters_files/plotly-binding-4.10.4/plotly.js"></script><script src="calibrate-simulation-parameters_files/typedarray-0.1/typedarray.min.js"></script><link href="calibrate-simulation-parameters_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="calibrate-simulation-parameters_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="calibrate-simulation-parameters_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="calibrate-simulation-parameters_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calibrate simulation parameters</h1>
            
      

      <div class="d-none name"><code>calibrate-simulation-parameters.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arxiv.org/abs/2502.07366" class="external-link">RITHMS</a></span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/calibrate_params.Rmd: do not edit by hand -->
<p>After <a href="https://solenepety.github.io/RITHMS/docs/articles/import-data.html" class="external-link">loading</a>
your own dataset, we recommend performing a quick diagnosis to guide the
choice of parameters in the <code><a href="../reference/holo_simu.html">holo_simu()</a></code> simulation
framework. This vignette aims to support users in calibrating
simulations so that they better reflect the characteristics of their
data.</p>
<p>We focus here on two parameters that influence the behavior of the
simulation:</p>
<ul>
<li>
<strong>The genetic effect size</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">\sigma \beta</annotation></semantics></math>,
which shapes the distribution of QTLs effects across microbiome.</li>
<li>
<strong>The multinomial sampling size parameter</strong>, used to
perform the multinomial sampling step that converts abundances to counts
data.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilHvitfeldt/paletteer" class="external-link">paletteer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'data.table'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     between, first, last</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'plotly'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     last_plot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:graphics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     layout</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/" class="external-link">psych</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'psych'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %+%, alpha</span></span></code></pre></div>
<div class="section level2">
<h2 id="calibrating-the-genetic-effect-size">Calibrating the Genetic Effect Size<a class="anchor" aria-label="anchor" href="#calibrating-the-genetic-effect-size"></a>
</h2>
<p>The genetic effect size parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">\sigma \beta</annotation></semantics></math>
directly impacts the distribution of taxa heritabilities (Further
explanations are given in <a href="https://arxiv.org/abs/2502.07366" class="external-link">the
article</a>). The <code><a href="../reference/gen_effect_calibration.html">gen_effect_calibration()</a></code> function allows
users to evaluate how different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">\sigma \beta</annotation></semantics></math>
influence this distribution.</p>
<p>In practice, heritabilities for most taxa are expected to lie around
0.1, rarely exceeding 0.5 as suggested in <a href="https://pubmed.ncbi.nlm.nih.gov/36102532/" class="external-link">Zang et al.</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Deru</span><span class="op">)</span></span>
<span><span class="va">ToyData</span> <span class="op">&lt;-</span> <span class="va">Deru</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxa_assign_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formatting_data.html">assign_taxa</a></span><span class="op">(</span>founder_object <span class="op">=</span> <span class="va">ToyData</span><span class="op">)</span></span>
<span><span class="va">effect_size_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_effect_calibration.html">gen_effect_calibration</a></span><span class="op">(</span>founder_object <span class="op">=</span> <span class="va">ToyData</span>,</span>
<span>                                   taxa_assign_g <span class="op">=</span> <span class="va">taxa_assign_g</span>,</span>
<span>                                   correlation <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                   effect.size <span class="op">=</span> <span class="va">effect_size_vector</span>,</span>
<span>                                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Picking joint bandwidth of 0.036</span></span></code></pre>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p><strong>Select effect sizes that lead to taxa heritability
distributions consistent with the literature:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density_peaks</span> <span class="op">&lt;-</span> <span class="va">out_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    peak <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    peak_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">density_peaks</span> <span class="op">&lt;-</span> <span class="va">density_peaks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">peak_x</span> <span class="op">&lt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">out_data_filtered</span> <span class="op">&lt;-</span> <span class="va">out_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">density_peaks</span>, by <span class="op">=</span> <span class="st">"effect.size"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">out_data_filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Heritability</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">out_data</span><span class="op">$</span><span class="va">Heritability</span>, <span class="va">density_peaks</span><span class="op">$</span><span class="va">peak_x</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">density_peaks</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">peak_x</span>, y <span class="op">=</span> <span class="va">peak</span>, label <span class="op">=</span> <span class="va">effect.size</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      nudge_x <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>      nudge_y <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>      direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>      show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Taxa heritability"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>         fill <span class="op">=</span> <span class="st">"Genetic effect size"</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"Taxa heritability density, noise 0.5"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,</span>
<span>          panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"#e3e3e3"</span><span class="op">)</span>,</span>
<span>          panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"#e9e9e9"</span><span class="op">)</span>,</span>
<span>          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>          plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/paletteer/man/ggplot2-scales-discrete.html" class="external-link">scale_fill_paletteer_d</a></span><span class="op">(</span><span class="st">"werpals::uyuni"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/paletteer/man/ggplot2-scales-discrete.html" class="external-link">scale_color_paletteer_d</a></span><span class="op">(</span><span class="st">"werpals::uyuni"</span><span class="op">)</span></span>
<span> <span class="va">p2</span></span></code></pre></div>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Based on the <a href="https://pubmed.ncbi.nlm.nih.gov/36102532/" class="external-link">Zang
et al.</a> expectations, a reasonable distribution of taxa
heritabilities appears to correspond to a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mi>β</mi><mo>*</mo><msqrt><mrow><mi>Q</mi><mi>T</mi><msub><mi>L</mi><mi>o</mi></msub></mrow></msqrt><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\sigma \beta * \sqrt {QTL_o} = 0.3</annotation></semantics></math>
in the case of <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7538339/" class="external-link">Déru et
al. 2020</a> dataset.</p>
</div>
<div class="section level2">
<h2 id="calibrating-the-multinomial-sampling-size">Calibrating the Multinomial Sampling Size<a class="anchor" aria-label="anchor" href="#calibrating-the-multinomial-sampling-size"></a>
</h2>
<p>The multinomial sampling size is used to simulate count data based on
relative abundances, specially if the selection is based on diversity.
The default value (10,000) in the
<code><a href="../reference/richness_from_abundances_gen.html">richness_from_abundances_gen()</a></code> function was calibrated
using the <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7538339/" class="external-link">Déru et
al. (2020)</a> dataset and reflects its typical sequencing depths.</p>
<p>The counts are drawn according to a multinomial low such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M(N,p)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is the relative abundances vector and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
the sampling size. Let the following formula
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>10000</mn><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>,</mo><msub><mi>n</mi><mi>b</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M(10000, (p_{i,1}, ..., p_{i,n_b}))</annotation></semantics></math>.
This parameter should be adapted to your own dataset based on the
observed sequencing depth distribution.</p>
<p><strong>Sequencing depths distribution:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Deru</span><span class="op">)</span></span>
<span><span class="va">ToyData</span> <span class="op">&lt;-</span> <span class="va">Deru</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_depth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">ToyData</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">sample_depth</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">120</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"#1f618d"</span>, color <span class="op">=</span> <span class="st">"#1f618d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sequencing depths distribution of the microbiome"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Sequencing depth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of samples"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"data":[{"orientation":"v","width":[14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974791781,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974791781,14.092436974788143,14.092436974791781,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143,14.092436974788143],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[8286.3529411764684,8300.4453781512602,8314.5378151260484,8328.6302521008402,8342.7226890756283,8356.8151260504201,8370.9075630252082,8385,8399.0924369747881,8413.1848739495799,8427.2773109243681,8441.3697478991598,8455.462184873948,8469.5546218487398,8483.6470588235279,8497.7394957983197,8511.8319327731078,8525.9243697478996,8540.0168067226878,8554.1092436974795,8568.2016806722677,8582.2941176470558,8596.3865546218476,8610.4789915966358,8624.5714285714275,8638.6638655462157,8652.7563025210075,8666.8487394957956,8680.9411764705874,8695.0336134453755,8709.1260504201673,8723.2184873949554,8737.3109243697472,8751.4033613445354,8765.4957983193272,8779.5882352941153,8793.6806722689071,8807.7731092436952,8821.865546218487,8835.9579831932751,8850.0504201680669,8864.1428571428551,8878.2352941176468,8892.327731092435,8906.4201680672268,8920.5126050420149,8934.6050420168067,8948.6974789915948,8962.7899159663866,8976.8823529411748,8990.9747899159665,9005.0672268907547,9019.1596638655465,9033.2521008403346,9047.3445378151264,9061.4369747899145,9075.5294117647063,9089.6218487394945,9103.7142857142844,9117.8067226890744,9131.8991596638625,9145.9915966386543,9160.0840336134424,9174.1764705882342,9188.2689075630224,9202.3613445378141,9216.4537815126023,9230.5462184873941,9244.6386554621822,9258.731092436974,9272.8235294117621,9286.9159663865539,9301.0084033613421,9315.1008403361338,9329.193277310922,9343.2857142857138,9357.3781512605019,9371.4705882352937,9385.5630252100818,9399.6554621848736,9413.7478991596618,9427.8403361344535,9441.9327731092417,9456.0252100840335,9470.1176470588216,9484.2100840336134,9498.3025210084015,9512.3949579831933,9526.4873949579815,9540.5798319327732,9554.6722689075614,9568.7647058823532,9582.8571428571413,9596.9495798319331,9611.0420168067212,9625.134453781513,9639.2268907563011,9653.3193277310911,9667.4117647058811,9681.504201680671,9695.596638655461,9709.6890756302491,9723.7815126050409,9737.8739495798291,9751.9663865546208,9766.058823529409,9780.1512605042008,9794.2436974789889,9808.3361344537807,9822.4285714285688,9836.5210084033606,9850.6134453781488,9864.7058823529405,9878.7983193277287,9892.8907563025205,9906.9831932773086,9921.0756302521004,9935.1680672268885,9949.2605042016803,9963.3529411764684],"y":[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,1,0,0,0,0,1,1,0,0,0,0,1,1,1,2,2,1,1,3,2,3,2,4,3,1,9,4,6,6,5,6,7,13,19,14,16,18,18,35,22,26,37,43,49,49,57,54,61,55,46,38,21,7,4],"text":["count:  1<br />Depth: 8286.353","count:  0<br />Depth: 8300.445","count:  0<br />Depth: 8314.538","count:  0<br />Depth: 8328.630","count:  0<br />Depth: 8342.723","count:  0<br />Depth: 8356.815","count:  0<br />Depth: 8370.908","count:  0<br />Depth: 8385.000","count:  0<br />Depth: 8399.092","count:  0<br />Depth: 8413.185","count:  0<br />Depth: 8427.277","count:  0<br />Depth: 8441.370","count:  0<br />Depth: 8455.462","count:  0<br />Depth: 8469.555","count:  0<br />Depth: 8483.647","count:  0<br />Depth: 8497.739","count:  0<br />Depth: 8511.832","count:  0<br />Depth: 8525.924","count:  0<br />Depth: 8540.017","count:  0<br />Depth: 8554.109","count:  0<br />Depth: 8568.202","count:  0<br />Depth: 8582.294","count:  0<br />Depth: 8596.387","count:  0<br />Depth: 8610.479","count:  0<br />Depth: 8624.571","count:  0<br />Depth: 8638.664","count:  0<br />Depth: 8652.756","count:  0<br />Depth: 8666.849","count:  0<br />Depth: 8680.941","count:  0<br />Depth: 8695.034","count:  0<br />Depth: 8709.126","count:  0<br />Depth: 8723.218","count:  0<br />Depth: 8737.311","count:  0<br />Depth: 8751.403","count:  0<br />Depth: 8765.496","count:  0<br />Depth: 8779.588","count:  0<br />Depth: 8793.681","count:  0<br />Depth: 8807.773","count:  0<br />Depth: 8821.866","count:  0<br />Depth: 8835.958","count:  0<br />Depth: 8850.050","count:  0<br />Depth: 8864.143","count:  0<br />Depth: 8878.235","count:  0<br />Depth: 8892.328","count:  0<br />Depth: 8906.420","count:  0<br />Depth: 8920.513","count:  0<br />Depth: 8934.605","count:  0<br />Depth: 8948.697","count:  1<br />Depth: 8962.790","count:  0<br />Depth: 8976.882","count:  0<br />Depth: 8990.975","count:  0<br />Depth: 9005.067","count:  0<br />Depth: 9019.160","count:  0<br />Depth: 9033.252","count:  0<br />Depth: 9047.345","count:  0<br />Depth: 9061.437","count:  0<br />Depth: 9075.529","count:  0<br />Depth: 9089.622","count:  0<br />Depth: 9103.714","count:  0<br />Depth: 9117.807","count:  0<br />Depth: 9131.899","count:  0<br />Depth: 9145.992","count:  0<br />Depth: 9160.084","count:  1<br />Depth: 9174.176","count:  2<br />Depth: 9188.269","count:  0<br />Depth: 9202.361","count:  1<br />Depth: 9216.454","count:  0<br />Depth: 9230.546","count:  0<br />Depth: 9244.639","count:  0<br />Depth: 9258.731","count:  0<br />Depth: 9272.824","count:  1<br />Depth: 9286.916","count:  1<br />Depth: 9301.008","count:  0<br />Depth: 9315.101","count:  0<br />Depth: 9329.193","count:  0<br />Depth: 9343.286","count:  0<br />Depth: 9357.378","count:  1<br />Depth: 9371.471","count:  1<br />Depth: 9385.563","count:  1<br />Depth: 9399.655","count:  2<br />Depth: 9413.748","count:  2<br />Depth: 9427.840","count:  1<br />Depth: 9441.933","count:  1<br />Depth: 9456.025","count:  3<br />Depth: 9470.118","count:  2<br />Depth: 9484.210","count:  3<br />Depth: 9498.303","count:  2<br />Depth: 9512.395","count:  4<br />Depth: 9526.487","count:  3<br />Depth: 9540.580","count:  1<br />Depth: 9554.672","count:  9<br />Depth: 9568.765","count:  4<br />Depth: 9582.857","count:  6<br />Depth: 9596.950","count:  6<br />Depth: 9611.042","count:  5<br />Depth: 9625.134","count:  6<br />Depth: 9639.227","count:  7<br />Depth: 9653.319","count: 13<br />Depth: 9667.412","count: 19<br />Depth: 9681.504","count: 14<br />Depth: 9695.597","count: 16<br />Depth: 9709.689","count: 18<br />Depth: 9723.782","count: 18<br />Depth: 9737.874","count: 35<br />Depth: 9751.966","count: 22<br />Depth: 9766.059","count: 26<br />Depth: 9780.151","count: 37<br />Depth: 9794.244","count: 43<br />Depth: 9808.336","count: 49<br />Depth: 9822.429","count: 49<br />Depth: 9836.521","count: 57<br />Depth: 9850.613","count: 54<br />Depth: 9864.706","count: 61<br />Depth: 9878.798","count: 55<br />Depth: 9892.891","count: 46<br />Depth: 9906.983","count: 38<br />Depth: 9921.076","count: 21<br />Depth: 9935.168","count:  7<br />Depth: 9949.261","count:  4<br />Depth: 9963.353"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(31,97,141,0.3)","line":{"width":1.8897637795275593,"color":"rgba(31,97,141,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.358882994166862,"r":7.3059360730593621,"b":41.778974318367787,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Sequencing depths distribution of the microbiome","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[8194.7521008403346,10054.953781512602],"tickmode":"array","ticktext":["8500","9000","9500","10000"],"tickvals":[8500,9000,9500,10000],"categoryorder":"array","categoryarray":["8500","9000","9500","10000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Sequencing depth","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.0500000000000003,64.049999999999997],"tickmode":"array","ticktext":["0","20","40","60"],"tickvals":[0,20,40,60],"categoryorder":"array","categoryarray":["0","20","40","60"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of samples","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2013527faf8f":{"x":{},"type":"bar"}},"cur_data":"2013527faf8f","visdat":{"2013527faf8f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> </span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">sample_depth</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Depth</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#1f618d"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sequencing depths distribution of microbiome"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Microbiome"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Sequencing depth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"data":[{"x":[9827,9719,9790,9759,9806,9671,9785,9833,9682,9868,9879,9833,9874,9772,9868,9723,9550,9917,9841,9926,9921,9808,9942,9903,9933,9958,9885,9815,9811,9616,9845,9787,9696,9740,9865,9700,9620,9660,9790,9792,9781,9896,9859,9880,9795,9796,9809,9849,9708,9858,9880,9695,9755,9610,9586,9806,9681,9887,9645,9706,9723,9727,9932,9940,9884,9367,9749,9908,9832,9939,9852,9887,9830,9717,9814,9757,9410,9819,8288,9846,9573,9867,9535,9835,9834,9834,9900,9788,9808,9845,9808,9804,9736,9509,9766,9863,9781,9926,9836,9883,9863,9845,9885,9922,9912,9747,9909,9908,9839,9855,9851,9915,9868,9900,9662,9472,9799,9839,9922,9846,9844,9877,9871,9874,9846,9856,9798,9878,9754,9681,9820,9922,9753,9851,9822,9872,9881,9860,9922,9852,9761,9715,9778,9830,9626,9923,9965,9950,9795,9918,9820,9942,9925,9879,9903,9944,9924,9916,9886,9870,9913,9781,9856,9825,9919,9923,9808,9783,9865,9852,9868,9784,9569,9897,9881,9280,9401,9871,9815,9804,9899,9841,9710,9887,9761,9658,9382,9882,9408,9603,9776,9804,9871,9753,9870,9930,9869,9571,9868,9638,9877,9878,9947,9784,9935,9736,9895,9882,9898,9863,9938,9929,9889,9668,9753,9828,9612,9789,9925,9502,9801,9879,9725,9900,9866,9890,9818,9901,9837,9852,9570,9893,9812,9869,9855,9787,9816,9831,9851,9804,9703,9689,9586,9850,9787,9891,9678,9767,9778,9835,9916,9725,9872,9795,9857,9911,9881,9869,9912,9740,9853,9903,9755,9217,9869,9699,9745,9475,9756,9760,9802,9808,9747,9791,9752,9759,9734,9807,9855,9684,9747,9773,9770,9758,9660,9496,9872,9923,9711,9876,9906,9892,9821,9733,9873,9797,9822,9882,9873,9847,9854,9906,9905,9869,9874,9927,9564,9462,9812,9829,9861,9776,9826,9834,9728,9701,9899,9844,9833,9859,9728,9907,9836,9839,9869,9831,9667,9714,9687,9643,9684,9764,9745,9743,9727,9904,9688,9790,9735,9804,9825,9892,9759,9630,9689,9841,9854,9749,9737,9876,9911,9872,9783,9896,9786,9671,9865,9701,9883,9873,9739,9836,9845,9900,9870,9887,9922,9912,9879,9789,9739,9902,9861,9905,9870,9870,9919,9871,9880,9846,9703,9616,9879,9709,9917,9827,9760,9918,9811,9913,9900,9861,9899,9875,9896,9798,9798,9821,9823,9802,9839,9804,9642,9847,9595,9691,9733,9693,9795,9849,9929,9880,9744,9821,9780,9772,9658,9914,9873,9705,9840,9682,9822,9827,9755,9854,9879,9804,9902,9815,9722,9835,9655,9782,9854,9533,9670,9805,9727,9850,9445,9720,9797,9897,9182,9836,9806,9487,9661,9777,9576,9754,9612,9847,9804,9696,9856,9860,9827,9758,9838,9827,9772,9852,9814,9720,9815,9915,9899,9868,9899,9809,9852,9679,9854,9786,9665,9511,9950,9735,9805,9857,9622,9740,9902,9529,9887,9801,9908,9710,9688,9885,9852,9843,9916,9881,9756,9686,9829,9892,9657,9832,9897,9917,9827,9891,9872,9867,9819,9867,9894,9748,9829,9835,9892,9716,9852,9757,9891,9818,9884,9811,9801,9600,9870,9819,9792,9843,9750,9799,8964,9721,9921,9877,9890,9855,9897,9749,9848,9820,9832,9862,9904,9898,9910,9898,9797,9798,9843,9876,9804,9426,9770,9594,9768,9782,9813,9825,9795,9814,9910,9714,9942,9898,9927,9820,9856,9839,9926,9772,9584,9670,9711,9862,9689,9878,9745,9928,9843,9768,9796,9850,9864,9822,9862,9898,9898,9762,9843,9861,9906,9770,9869,9696,9742,9856,9750,9679,9840,9882,9681,9917,9957,9947,9817,9864,9914,9855,9809,9828,9906,9871,9892,9805,9856,9841,9874,9841,9834,9792,9907,9873,9792,9896,9785,9911,9866,9841,9876,9778,9828,9636,9827,9709,9844,9857,9929,9951,9905,9938,9751,9944,9876,9923,9963,9933,9924,9849,9928,9812,9933,9830,9848,9677,9834,9870,9834,9821,9850,9423,9906,9890,9935,9876,9939,9912,9796,9731,9880,9892,9743,9822,9574,9773,9540,9769,9825,9814,9169,9604,9827,9915,9708,9938,9880,9817,9832,9879,9861,9872,9469,9809,9684,9897,9761,9629,9652,9595,9793,9665,9529,9574,9750,9792,9854,9753,9664,9817,9886,9918,9832,9781,9888,9819,9728,9773,9890,9849,9819,9931,9722,9881,9826,9498,9880,9865,9869,9883,9894,9889,9888,9565,9815,9851,9488,9900,9897,9937,9888,9909,9895,9889,9915,9911,9867,9820,9796,9678,9747,9892,9787,9785,9665,9752,9727,9836,9301,9186,9642,9792,9818,9800,9876,9905,9682,9533,9898,9789,9843,9600,9913,9685,9826,9546,9826,9563,9893,9674,9881,9697],"y":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"hoverinfo":"x","type":"box","fillcolor":"rgba(31,97,141,0.3)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","orientation":"h","frame":null}],"layout":{"margin":{"t":45.358882994166862,"r":7.3059360730593621,"b":41.778974318367787,"l":25.570776255707766},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Sequencing depths distribution of microbiome","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[8204.1499999999996,10048.85],"tickmode":"array","ticktext":["8500","9000","9500","10000"],"tickvals":[8500,9000,9500,10000],"categoryorder":"array","categoryarray":["8500","9000","9500","10000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Sequencing depth","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,1.6000000000000001],"tickmode":"array","ticktext":[""],"tickvals":[1],"categoryorder":"array","categoryarray":[""],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Microbiome","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"201368e65e2a":{"x":{},"y":{},"type":"box"}},"cur_data":"201368e65e2a","visdat":{"201368e65e2a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Both the arithmetic and geometric means of sequencing depths must be
calculated to guide your choice. If the distribution is biased due to
outliers, the geometric mean may be more appropriate.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_depth</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9798.283</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/geometric.mean.html" class="external-link">geometric.mean</a></span><span class="op">(</span><span class="va">sample_depth</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9797.366</span></span></code></pre></div>
<p>In this example, both means are close to 10,000, supporting the
default parameter value for this dataset.</p>
<p>This vignette provides guidelines for calibrating these two
parameters in the <code><a href="../reference/holo_simu.html">holo_simu()</a></code> simulation framework based on
a new dataset. These two parameters can be specified in the
<code><a href="../reference/holo_simu.html">holo_simu()</a></code> call, as well :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">generations_simu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/holo_simu.html">holo_simu</a></span><span class="op">(</span>founder_object <span class="op">=</span> <span class="va">ToyData</span>,</span>
<span>                              h2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              b2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              n_ind <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                              n_clust <span class="op">=</span> <span class="va">taxa_assign_g</span>,</span>
<span>                              effect.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                              size_rmultinom <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<p>If you want to reproduce the <a href="https://solenepety.github.io/RITHMS/articles/generate-figures.html" class="external-link">figures
in the article</a> from your own dataset, remember to modify the
<code>size_rmultinom</code> parameter of
<code><a href="../reference/richness_from_abundances_gen.html">richness_from_abundances_gen()</a></code> when computing <a href="https://solenepety.github.io/RITHMS/articles/generate-figures.html#alpha-diversity-remains-stable-across-generations" class="external-link">diversity</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Solène Pety, Ingrid David, Youna Maillié, Andrea Rau, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
