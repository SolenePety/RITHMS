<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibrate simulation parameters • RITHMS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate simulation parameters">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RITHMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/generate-figures.html">Generate figures</a></li>
    <li><a class="dropdown-item" href="../articles/import-data.html">Data Importation</a></li>
    <li><a class="dropdown-item" href="../articles/calibrate-simulation-parameters.html">Calibrate simulation parameters</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SolenePety/RITHMS"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calibrate simulation parameters</h1>
            
      

      <div class="d-none name"><code>calibrate-simulation-parameters.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arxiv.org/abs/2502.07366" class="external-link">RITHMS</a></span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/calibrate_params.Rmd: do not edit by hand -->
<p>After <a href="https://solenepety.github.io/RITHMS/docs/articles/import-data.html" class="external-link">loading</a>
your own dataset, we recommend performing a quick diagnosis to guide the
choice of parameters in the <code><a href="../reference/holo_simu.html">holo_simu()</a></code> simulation
framework. This vignette aims to support users in calibrating
simulations so that they better reflect the characteristics of their
data.</p>
<p>We focus here on two parameters that influence the behavior of the
simulation:</p>
<ul>
<li>
<strong>The genetic effect size</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>β</mi></msub><annotation encoding="application/x-tex">\sigma_\beta</annotation></semantics></math>,
which shapes the distribution of QTLs effects across microbiome.
<em>Note: The default value of this parameter is optimized to match the
<code>Deru</code> dataset, wich sets it to 0.3.</em>
</li>
<li>
<strong>The multinomial sampling size parameter</strong>, used to
perform the multinomial sampling step that converts abundances to counts
data. <em>Note: The default value of this parameter is optimized to
match the <code>Deru</code> dataset, wich sets it to 10,000.</em>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilHvitfeldt/paletteer" class="external-link">paletteer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/" class="external-link">psych</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="calibrating-the-genetic-effect-size">Calibrating the Genetic Effect Size<a class="anchor" aria-label="anchor" href="#calibrating-the-genetic-effect-size"></a>
</h2>
<p>The genetic effect size parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>β</mi></msub><annotation encoding="application/x-tex">\sigma_\beta</annotation></semantics></math>
directly impacts the distribution of taxa heritabilities (Further
explanations are given in <span class="citation">Pety et al. (<a href="#ref-https://doi.org/10.48550/arxiv.2502.07366" class="external-link">2025</a>)</span>
). The <code><a href="../reference/gen_effect_calibration.html">gen_effect_calibration()</a></code> function allows users to
evaluate how different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>β</mi></msub><annotation encoding="application/x-tex">\sigma_\beta</annotation></semantics></math>
influence this distribution.</p>
<p>In practice, heritabilities for most taxa are expected to lie around
0.1, rarely exceeding 0.5 as suggested in <span class="citation">Zang et
al. (<a href="#ref-Zang2022">2022</a>)</span> .</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Deru</span><span class="op">)</span></span>
<span><span class="va">ToyData</span> <span class="op">&lt;-</span> <span class="va">Deru</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxa_assign_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formatting_data.html">assign_taxa</a></span><span class="op">(</span>founder_object <span class="op">=</span> <span class="va">ToyData</span><span class="op">)</span></span>
<span><span class="va">effect_size_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_effect_calibration.html">gen_effect_calibration</a></span><span class="op">(</span>founder_object <span class="op">=</span> <span class="va">ToyData</span>,</span>
<span>                                   taxa_assign_g <span class="op">=</span> <span class="va">taxa_assign_g</span>,</span>
<span>                                   correlation <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                   effect.size <span class="op">=</span> <span class="va">effect_size_vector</span>,</span>
<span>                                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="700"></p>
<pre><code><span><span class="co">#&gt; Picking joint bandwidth of 0.036</span></span></code></pre>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-5-2.png" class="r-plt" width="700"></p>
<p><strong>Select effect sizes that lead to taxa heritability
distributions consistent with the literature:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density_peaks</span> <span class="op">&lt;-</span> <span class="va">out_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    peak <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    peak_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Heritability</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">out_data_filtered</span> <span class="op">&lt;-</span> <span class="va">out_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">density_peaks</span>, by <span class="op">=</span> <span class="st">"effect.size"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">out_data_filtered</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Heritability</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">density_peaks</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">peak_x</span>, y <span class="op">=</span> <span class="va">peak</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">effect.size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Taxa heritability"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Genetic effect size"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Taxa heritability density, noise 0.5"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"#e3e3e3"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"#e9e9e9"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/paletteer/man/ggplot2-scales-discrete.html" class="external-link">scale_fill_paletteer_d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"werpals"</span>, <span class="st">"::"</span>, <span class="st">"uyuni"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/paletteer/man/ggplot2-scales-discrete.html" class="external-link">scale_color_paletteer_d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"werpals"</span>, <span class="st">"::"</span>, <span class="st">"uyuni"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#ggplotly(p2) easier to navigate on this plot with ggplotly</span></span></code></pre></div>
<p>Based on the <span class="citation">Zang et al. (<a href="#ref-Zang2022">2022</a>)</span> expectations, a reasonable
distribution of taxa heritabilities appears to correspond to a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>β</mi></msub><mo>*</mo><msqrt><mrow><mi>Q</mi><mi>T</mi><msub><mi>L</mi><mi>o</mi></msub></mrow></msqrt><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\sigma_\beta * \sqrt {QTL_o} = 0.3</annotation></semantics></math>
in the case of <span class="citation">Déru et al. (<a href="#ref-Dru2020">2020</a>)</span> dataset.</p>
</div>
<div class="section level2">
<h2 id="calibrating-the-multinomial-sampling-size">Calibrating the Multinomial Sampling Size<a class="anchor" aria-label="anchor" href="#calibrating-the-multinomial-sampling-size"></a>
</h2>
<p>The multinomial sampling size is used to simulate count data based on
relative abundances, specially if the selection is based on diversity.
The default value (10,000) in the
<code><a href="../reference/richness_from_abundances_gen.html">richness_from_abundances_gen()</a></code> function was calibrated
using the <code>Deru</code> dataset and reflects its typical sequencing
depths.</p>
<p>The counts are drawn according to a multinomial low such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M(N,p)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is the relative abundances vector and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
the sampling size. Let the following formula
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>10000</mn><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>,</mo><msub><mi>n</mi><mi>b</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M(10000, (p_{i,1}, ..., p_{i,n_b}))</annotation></semantics></math>.
This parameter should be adapted to your own dataset based on the
observed sequencing depth distribution.</p>
<p><strong>Sequencing depths distribution:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Deru</span><span class="op">)</span></span>
<span><span class="va">ToyData</span> <span class="op">&lt;-</span> <span class="va">Deru</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_depth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">ToyData</span><span class="op">$</span><span class="va">microbiome</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">sample_depth</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">120</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"#1f618d"</span>, color <span class="op">=</span> <span class="st">"#1f618d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sequencing depths distribution of the microbiome"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Sequencing depth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of samples"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="calibrate-simulation-parameters_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sample_depth</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    8288    9753    9830    9798    9880    9965</span></span></code></pre></div>
<p>We suggest using the median to promote robustness against potential
outliers present in the dataset. In this example, the median is close to
10,000, supporting the default parameter value for this dataset.</p>
</div>
<div class="section level2">
<h2 id="summary-of-parameter-calibration">Summary of parameter calibration<a class="anchor" aria-label="anchor" href="#summary-of-parameter-calibration"></a>
</h2>
<p>This vignette provides guidelines for calibrating these two
parameters in the <code><a href="../reference/holo_simu.html">holo_simu()</a></code> simulation framework based on
a new dataset. These two parameters can be specified in the
<code><a href="../reference/holo_simu.html">holo_simu()</a></code> call, as well :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">generations_simu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/holo_simu.html">holo_simu</a></span><span class="op">(</span>founder_object <span class="op">=</span> <span class="va">ToyData</span>,</span>
<span>                              h2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              b2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              n_ind <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                              n_clust <span class="op">=</span> <span class="va">taxa_assign_g</span>,</span>
<span>                              effect.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                              size_rmultinom <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<p>If you want to reproduce the <a href="https://solenepety.github.io/RITHMS/articles/generate-figures.html" class="external-link">figures
in the article</a> from your own dataset, remember to modify the
<code>size_rmultinom</code> parameter of
<code><a href="../reference/richness_from_abundances_gen.html">richness_from_abundances_gen()</a></code> when computing <a href="https://solenepety.github.io/RITHMS/articles/generate-figures.html#alpha-diversity-remains-stable-across-generations" class="external-link">diversity</a>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Dru2020" class="csl-entry">
Déru, V., A. Bouquet, C. Hassenfratz, B. Blanchet, C. Carillier-Jacquin,
and H. Gilbert. 2020. <span>“Impact of a High-Fibre Diet on Genetic
Parameters of Production Traits in Growing Pigs.”</span> <em>Animal</em>
14 (11): 2236–45. <a href="https://doi.org/10.1017/s1751731120001275" class="external-link">https://doi.org/10.1017/s1751731120001275</a>.
</div>
<div id="ref-https://doi.org/10.48550/arxiv.2502.07366" class="csl-entry">
Pety, Solène, Mahendra Mariadassou, Ingrid David, and Andrea Rau. 2025.
<span>“RITHMS : An Advanced Stochastic Framework for the Simulation of
Transgenerational Hologenomic Data.”</span> <a href="https://doi.org/10.48550/ARXIV.2502.07366" class="external-link">https://doi.org/10.48550/ARXIV.2502.07366</a>.
</div>
<div id="ref-Zang2022" class="csl-entry">
Zang, Xin-Wei, Hui-Zeng Sun, Ming-Yuan Xue, Zhe Zhang, Graham Plastow,
Tianfu Yang, Le Luo Guan, and Jian-Xin Liu. 2022. <span>“Heritable and
Nonheritable Rumen Bacteria Are Associated with Different Characters of
Lactation Performance of Dairy Cows.”</span> Edited by Jessica L.
Metcalf. <em>mSystems</em> 7 (5). <a href="https://doi.org/10.1128/msystems.00422-22" class="external-link">https://doi.org/10.1128/msystems.00422-22</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Solène Pety, Ingrid David, Youna Maillié, Andrea Rau, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
