<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Advanced Stochastic Framework for the Simulation of Transgenerational Hologenomic Data • RITHMS</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="An Advanced Stochastic Framework for the Simulation of Transgenerational Hologenomic Data">
<meta name="description" content="RITHMS, an R Implementation of a Transgenerational Hologenomic Model-based Simulator is an open-source package, builds upon the MoBPS package and incorporates the distinctive architecture of the microbiota, notably vertical and horizontal transfer as well as modulation due to the environment and host genetics.">
<meta property="og:description" content="RITHMS, an R Implementation of a Transgenerational Hologenomic Model-based Simulator is an open-source package, builds upon the MoBPS package and incorporates the distinctive architecture of the microbiota, notably vertical and horizontal transfer as well as modulation due to the environment and host genetics.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">RITHMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="articles/generate-figures.html">Generate figures</a></li>
    <li><a class="dropdown-item" href="articles/import-data.html">Data Importation</a></li>
    <li><a class="dropdown-item" href="articles/calibrate-simulation-parameters.html">Calibrate simulation parameters</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SolenePety/RITHMS"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rithms-">RITHMS <img src="reference/figures/hex_rithms.png" align="right" width="155" height="180"><a class="anchor" aria-label="anchor" href="#rithms-"></a>
</h1></div>
<!-- badges: start -->
<p>Our framework, <strong>R</strong> <strong>I</strong>mplementation of a <strong>T</strong>ransgenerational <strong>H</strong>ologenomic <strong>M</strong>odel-based <strong>S</strong>imulator (RITHMS) is an open-source package, builds upon the MoBPS package and incorporates the distinctive architecture of the microbiota, notably vertical and horizontal transfer as well as modulation due to the environment and host genetics. In addition, RITHMS can account for a variety of selection strategies, is adaptable to different genetic architectures. <!-- badges: end --></p>
<p>Full documentation website on: <a href="https://SolenePety.github.io/RITHMS" class="external-link uri">https://SolenePety.github.io/RITHMS</a><br>
Last code version on: <a href="https://github.com/SolenePety/RITHMS" class="external-link uri">https://github.com/SolenePety/RITHMS</a></p>
<p>Here is a little summary of how RITHMS work, but you can read the <a href="https://arxiv.org/abs/2502.07366" class="external-link">preprint</a> for more details.</p>
<p><img src="reference/figures/core_algorithm.png"></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of RITHMS from GitHub using <code>remotes</code> as shown below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># install.packages("remotes")</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"SolenePety/RITHMS"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="toy-dataset">Toy dataset<a class="anchor" aria-label="anchor" href="#toy-dataset"></a>
</h2>
<p>You already have a toy dataset, a subset from <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7538339/" class="external-link">Déru et al. 2020</a>, there are <strong>1845 species</strong> and <strong>780 individuals</strong>, that show you the expected structure of input data :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arxiv.org/abs/2502.07366" class="external-link">RITHMS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Deru"</span><span class="op">)</span></span>
<span><span class="va">ToyData</span> <span class="op">&lt;-</span> <span class="va">Deru</span></span></code></pre></div>
<p>To import your own dataset, you can refer to the following <a href="https://solenepety.github.io/RITHMS/articles/import-data.html" class="external-link">vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="quick-start-from-the-toy-dataset">Quick Start from the toy dataset<a class="anchor" aria-label="anchor" href="#quick-start-from-the-toy-dataset"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxa_assign_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/formatting_data.html">assign_taxa</a></span><span class="op">(</span><span class="va">ToyData</span><span class="op">)</span></span>
<span><span class="va">generations_simu</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/holo_simu.html">holo_simu</a></span><span class="op">(</span>h2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              b2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              founder_object <span class="op">=</span> <span class="va">ToyData</span>,</span>
<span>                              n_clust <span class="op">=</span> <span class="va">taxa_assign_g</span>,</span>
<span>                              n_ind <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start-from-your-own-dataset">Quick Start from your own dataset<a class="anchor" aria-label="anchor" href="#quick-start-from-your-own-dataset"></a>
</h2>
<p>If you’re using your own dataset instead of the toy dataset, make sure to calibrate the simulation parameters accordingly. In particular, the <code>n_ind</code> (number of individuals in each generation), the genetic effect size <code>effect.size</code> and the multinomial sampling size parameter <code>size_rmultinom</code> used in holo_simu() should be consistent with the characteristics of your dataset.</p>
<p>To help you with this, please refer to the <a href="https://solenepety.github.io/RITHMS/articles/calibrate-simulation-parameters.html" class="external-link">dedicated vignette</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># from VCf format</span></span>
<span><span class="va">founder_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_input_data.html">read_input_data</a></span><span class="op">(</span>path_to_microbiome <span class="op">=</span> <span class="st">"/path/to/microbiome.txt"</span>,</span>
<span>                                  path_to_pedmap <span class="op">=</span> <span class="st">"/path/to/vcf/'prefix'"</span>,</span>
<span>                                  biome_id_column <span class="op">=</span> <span class="st">"ind_id"</span><span class="op">)</span></span>
<span><span class="co"># from Ped/Map format</span></span>
<span><span class="va">founder_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_input_data.html">read_input_data</a></span><span class="op">(</span>path_to_microbiome <span class="op">=</span> <span class="st">"/path/to/microbiome.txt"</span>,</span>
<span>                                  path_to_pedmap <span class="op">=</span> <span class="st">"/path/to/pedmap/'prefix'"</span>,</span>
<span>                                  biome_id_column <span class="op">=</span> <span class="st">"ind_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">taxa_assign_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/formatting_data.html">assign_taxa</a></span><span class="op">(</span><span class="va">founder_object</span><span class="op">)</span></span>
<span><span class="va">generations_simu</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/holo_simu.html">holo_simu</a></span><span class="op">(</span>h2 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                              b2 <span class="op">=</span> <span class="fl">0.25</span>, </span>
<span>                              founder_object <span class="op">=</span> <span class="va">founder_object</span>,</span>
<span>                              n_clust <span class="op">=</span> <span class="va">taxa_assign_g</span>,</span>
<span>                              n_ind <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                              effect.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                              size_rmultinom <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="co"># Choose n_ind, effect.size and size_rmultinom such that it is consistent with the initial dimensions of your data set</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="to-go-further">To go further<a class="anchor" aria-label="anchor" href="#to-go-further"></a>
</h2>
<p>If you’re interested into reproducing the figures of the article you can take a look at <a href="https://solenepety.github.io/RITHMS/articles/generate-figures.html#fine-selection-of-h2_d-b2-and-selection-schemes" class="external-link">this vignette</a> to generate the figures coming from the article</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RITHMS</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Solène Pety <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-1245-7425" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Ingrid David <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0002-2514-6693" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Youna Maillié <br><small class="roles"> Author </small>   </li>
<li>Andrea Rau <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0001-6469-488X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Mahendra Mariadassou <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0003-2986-354X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Solène Pety, Ingrid David, Youna Maillié, Andrea Rau, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
